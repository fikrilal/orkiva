# -----------------------------------------------------------------------------
# Orkiva runtime configuration (MVP)
# Copy to `.env` and adjust for local environment.
# -----------------------------------------------------------------------------

# Core runtime
NODE_ENV=development
WORKSPACE_ID=wk_local

# Database
DATABASE_URL=postgres://postgres:postgres@localhost:54322/orkiva
DB_READY_MAX_ATTEMPTS=30
DB_READY_INTERVAL_MS=2000

# Auth / identity verification
AUTH_JWKS_URL=http://localhost:8080/.well-known/jwks.json
# Optional: inline JWKS JSON for local/dev runs (overrides AUTH_JWKS_URL when set)
# AUTH_JWKS_JSON={"keys":[...]}
AUTH_ISSUER=https://issuer.local
AUTH_AUDIENCE=orkiva

# API runtime
API_HOST=0.0.0.0
API_PORT=3000

# Worker runtime
WORKER_POLL_INTERVAL_MS=5000
WORKER_MAX_PARALLEL_JOBS=10
WORKER_BRIDGE_API_BASE_URL=http://127.0.0.1:3000
WORKER_CALLBACK_MAX_RETRIES=3
WORKER_CALLBACK_REQUEST_TIMEOUT_MS=8000
# Optional local guard: only claim jobs created at/after this ISO timestamp.
# WORKER_MIN_JOB_CREATED_AT=2026-02-21T01:13:50.000Z
# WORKER_BRIDGE_ACCESS_TOKEN=<platform-issued-service-token-with-message-write-scope>

# Trigger and loop guard policy (locked MVP defaults)
TRIGGER_ACK_TIMEOUT_MS=8000
TRIGGER_MAX_RETRIES=2
TRIGGER_RESUME_MAX_ATTEMPTS=2
TRIGGER_QUIET_WINDOW_MS=20000
TRIGGER_RECHECK_MS=5000
TRIGGER_MAX_DEFER_MS=60000
TRIGGERING_LEASE_TIMEOUT_MS=45000
AUTO_UNREAD_ENABLED=true
AUTO_UNREAD_MAX_TRIGGERS_PER_WINDOW=3
AUTO_UNREAD_WINDOW_MS=300000
AUTO_UNREAD_MIN_INTERVAL_MS=30000
AUTO_UNREAD_BREAKER_BACKLOG_THRESHOLD=50
AUTO_UNREAD_BREAKER_COOLDOWN_MS=60000
LOOP_MAX_TURNS=20
LOOP_MAX_REPEATED_FINDINGS=3
SESSION_STALE_AFTER_HOURS=12

# Data policy (locked personal MVP)
RETENTION_MODE=permanent
ENABLE_AUTOMATED_REDACTION=false

# Observability
LOG_LEVEL=info
METRICS_ENABLED=true
METRICS_PORT=9464
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
